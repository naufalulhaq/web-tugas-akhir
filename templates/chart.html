{% extends "layout.html" %}

{% block title %}Chart{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">Line chart</h4>
          <canvas id="lineChart_traffic"></canvas>
        </div>
      </div>
    </div>
{% endblock %}

{% block scripts %}
<script src="{{ baseurl('assets/js/chart.js') }}"></script>
<script src="{{ baseurl('assets/vendors/chart.js/Chart.min.js') }}"></script>

<script>
  var res = {
      "date_time": {{ results["date_time"] | tojson | safe }},
      "traffic_volume": {{ results["traffic_volume"] | tojson | safe }}
  };


  var options = {
	responsive: true,
	interaction: {
		intersect: false,
	},
	scales: {
		yAxes: [{
			ticks: {
				beginAtZero: true
			},
      gridLines: {
        display: false,
      },
		}]
	},
	legend: {
		display: false
	},
	elements: {
		point: {
			radius: 2
		}
	}
};


  console.log("Data:", res);
  
  'use strict';
  var trafficData = {
      labels: res["date_time"],
      datasets: [
        {
          label: 'Trafic Volume',
          data: res["traffic_volume"],
          backgroundColor: 'rgba(75, 192, 192, 0.2)', // Different color for better visibility
          borderColor: 'rgba(31, 59, 179, 100)',
          borderWidth: 3,
          // cubicInterpolationMode: 'monotone',
          tension: 0.2,
          fill: false
        }
      ]
  };
  
  var traffic = document.getElementById('lineChart_traffic').getContext('2d');
  var trafficChart = new Chart(traffic, {
      type: 'line',
      data: trafficData,
      options: options
  });


  console.log("Charts initialized successfully.");
</script>
{% endblock %}